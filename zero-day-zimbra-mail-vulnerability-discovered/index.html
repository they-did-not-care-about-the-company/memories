<!DOCTYPE html><html lang="en-US"><head>    <meta charset="UTF-8">    <meta http-equiv="X-UA-Compatible" content="IE=edge">    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">    <meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' /><!-- This site is optimized with the Yoast SEO plugin v18.5.1  --><title>Zero Day Zimbra Mail Vulnerability Discovered - CTemplar</title><!-- / Yoast SEO plugin. --><link rel='dns-prefetch' href='//s.w.org' /><link rel='stylesheet' id='wp-block-library-css'  href='https://ctemplar.com/wp-includes/css/dist/block-library/style.min.css?ver=5.9.3' type='text/css' media='all' /><link rel="canonical" href="https://liverado.com/zero-day-zimbra-mail-vulnerability-discovered/" /><style id='global-styles-inline-css' type='text/css'>body{--wp--preset--color--black: #000000;--wp--preset--color--cyan-bluish-gray: #abb8c3;--wp--preset--color--white: #ffffff;--wp--preset--color--pale-pink: #f78da7;--wp--preset--color--vivid-red: #cf2e2e;--wp--preset--color--luminous-vivid-orange: #ff6900;--wp--preset--color--luminous-vivid-amber: #fcb900;--wp--preset--color--light-green-cyan: #7bdcb5;--wp--preset--color--vivid-green-cyan: #00d084;--wp--preset--color--pale-cyan-blue: #8ed1fc;--wp--preset--color--vivid-cyan-blue: #0693e3;--wp--preset--color--vivid-purple: #9b51e0;--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple: linear-gradient(135deg,rgba(6,147,227,1) 0%,rgb(155,81,224) 100%);--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan: linear-gradient(135deg,rgb(122,220,180) 0%,rgb(0,208,130) 100%);--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange: linear-gradient(135deg,rgba(252,185,0,1) 0%,rgba(255,105,0,1) 100%);--wp--preset--gradient--luminous-vivid-orange-to-vivid-red: linear-gradient(135deg,rgba(255,105,0,1) 0%,rgb(207,46,46) 100%);--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray: linear-gradient(135deg,rgb(238,238,238) 0%,rgb(169,184,195) 100%);--wp--preset--gradient--cool-to-warm-spectrum: linear-gradient(135deg,rgb(74,234,220) 0%,rgb(151,120,209) 20%,rgb(207,42,186) 40%,rgb(238,44,130) 60%,rgb(251,105,98) 80%,rgb(254,248,76) 100%);--wp--preset--gradient--blush-light-purple: linear-gradient(135deg,rgb(255,206,236) 0%,rgb(152,150,240) 100%);--wp--preset--gradient--blush-bordeaux: linear-gradient(135deg,rgb(254,205,165) 0%,rgb(254,45,45) 50%,rgb(107,0,62) 100%);--wp--preset--gradient--luminous-dusk: linear-gradient(135deg,rgb(255,203,112) 0%,rgb(199,81,192) 50%,rgb(65,88,208) 100%);--wp--preset--gradient--pale-ocean: linear-gradient(135deg,rgb(255,245,203) 0%,rgb(182,227,212) 50%,rgb(51,167,181) 100%);--wp--preset--gradient--electric-grass: linear-gradient(135deg,rgb(202,248,128) 0%,rgb(113,206,126) 100%);--wp--preset--gradient--midnight: linear-gradient(135deg,rgb(2,3,129) 0%,rgb(40,116,252) 100%);--wp--preset--duotone--dark-grayscale: url('#wp-duotone-dark-grayscale');--wp--preset--duotone--grayscale: url('#wp-duotone-grayscale');--wp--preset--duotone--purple-yellow: url('#wp-duotone-purple-yellow');--wp--preset--duotone--blue-red: url('#wp-duotone-blue-red');--wp--preset--duotone--midnight: url('#wp-duotone-midnight');--wp--preset--duotone--magenta-yellow: url('#wp-duotone-magenta-yellow');--wp--preset--duotone--purple-green: url('#wp-duotone-purple-green');--wp--preset--duotone--blue-orange: url('#wp-duotone-blue-orange');--wp--preset--font-size--small: 13px;--wp--preset--font-size--medium: 20px;--wp--preset--font-size--large: 36px;--wp--preset--font-size--x-large: 42px;}.has-black-color{color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-color{color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-color{color: var(--wp--preset--color--white) !important;}.has-pale-pink-color{color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-color{color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-color{color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-color{color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-color{color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-color{color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-color{color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-color{color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-color{color: var(--wp--preset--color--vivid-purple) !important;}.has-black-background-color{background-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-background-color{background-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-background-color{background-color: var(--wp--preset--color--white) !important;}.has-pale-pink-background-color{background-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-background-color{background-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-background-color{background-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-background-color{background-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-background-color{background-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-background-color{background-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-background-color{background-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-background-color{background-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-background-color{background-color: var(--wp--preset--color--vivid-purple) !important;}.has-black-border-color{border-color: var(--wp--preset--color--black) !important;}.has-cyan-bluish-gray-border-color{border-color: var(--wp--preset--color--cyan-bluish-gray) !important;}.has-white-border-color{border-color: var(--wp--preset--color--white) !important;}.has-pale-pink-border-color{border-color: var(--wp--preset--color--pale-pink) !important;}.has-vivid-red-border-color{border-color: var(--wp--preset--color--vivid-red) !important;}.has-luminous-vivid-orange-border-color{border-color: var(--wp--preset--color--luminous-vivid-orange) !important;}.has-luminous-vivid-amber-border-color{border-color: var(--wp--preset--color--luminous-vivid-amber) !important;}.has-light-green-cyan-border-color{border-color: var(--wp--preset--color--light-green-cyan) !important;}.has-vivid-green-cyan-border-color{border-color: var(--wp--preset--color--vivid-green-cyan) !important;}.has-pale-cyan-blue-border-color{border-color: var(--wp--preset--color--pale-cyan-blue) !important;}.has-vivid-cyan-blue-border-color{border-color: var(--wp--preset--color--vivid-cyan-blue) !important;}.has-vivid-purple-border-color{border-color: var(--wp--preset--color--vivid-purple) !important;}.has-vivid-cyan-blue-to-vivid-purple-gradient-background{background: var(--wp--preset--gradient--vivid-cyan-blue-to-vivid-purple) !important;}.has-light-green-cyan-to-vivid-green-cyan-gradient-background{background: var(--wp--preset--gradient--light-green-cyan-to-vivid-green-cyan) !important;}.has-luminous-vivid-amber-to-luminous-vivid-orange-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-amber-to-luminous-vivid-orange) !important;}.has-luminous-vivid-orange-to-vivid-red-gradient-background{background: var(--wp--preset--gradient--luminous-vivid-orange-to-vivid-red) !important;}.has-very-light-gray-to-cyan-bluish-gray-gradient-background{background: var(--wp--preset--gradient--very-light-gray-to-cyan-bluish-gray) !important;}.has-cool-to-warm-spectrum-gradient-background{background: var(--wp--preset--gradient--cool-to-warm-spectrum) !important;}.has-blush-light-purple-gradient-background{background: var(--wp--preset--gradient--blush-light-purple) !important;}.has-blush-bordeaux-gradient-background{background: var(--wp--preset--gradient--blush-bordeaux) !important;}.has-luminous-dusk-gradient-background{background: var(--wp--preset--gradient--luminous-dusk) !important;}.has-pale-ocean-gradient-background{background: var(--wp--preset--gradient--pale-ocean) !important;}.has-electric-grass-gradient-background{background: var(--wp--preset--gradient--electric-grass) !important;}.has-midnight-gradient-background{background: var(--wp--preset--gradient--midnight) !important;}.has-small-font-size{font-size: var(--wp--preset--font-size--small) !important;}.has-medium-font-size{font-size: var(--wp--preset--font-size--medium) !important;}.has-large-font-size{font-size: var(--wp--preset--font-size--large) !important;}.has-x-large-font-size{font-size: var(--wp--preset--font-size--x-large) !important;}</style><link rel='stylesheet' id='ctemplar-bootstrap-css'  href='https://ctemplar.com/wp-content/themes/ctemplar/bootstrap/css/bootstrap.min.css' type='text/css' media='all' /><link rel='stylesheet' id='ctemplar-style-css'  href='https://ctemplar.com/wp-content/themes/ctemplar/style.css' type='text/css' media='all' /><link rel='stylesheet' id='ctemplar-all-css'  href='https://ctemplar.com/wp-content/themes/ctemplar/fontawesome/css/all.min.css' type='text/css' media='all' /><link rel="icon" href="https://ctemplar.com/wp-content/uploads/2020/07/cropped-logo-32x32.png" sizes="32x32" /><link rel="icon" href="https://ctemplar.com/wp-content/uploads/2020/07/cropped-logo-192x192.png" sizes="192x192" /><link rel="apple-touch-icon" href="https://ctemplar.com/wp-content/uploads/2020/07/cropped-logo-180x180.png" /><meta name="msapplication-TileImage" content="https://ctemplar.com/wp-content/uploads/2020/07/cropped-logo-270x270.png" />    </head>    <body class="post-template-default single single-post postid-1519 single-format-standard">        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-dark-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0.49803921568627" /><feFuncG type="table" tableValues="0 0.49803921568627" /><feFuncB type="table" tableValues="0 0.49803921568627" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-grayscale"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.54901960784314 0.98823529411765" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.71764705882353 0.25490196078431" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-red"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 1" /><feFuncG type="table" tableValues="0 0.27843137254902" /><feFuncB type="table" tableValues="0.5921568627451 0.27843137254902" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-midnight"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0 0" /><feFuncG type="table" tableValues="0 0.64705882352941" /><feFuncB type="table" tableValues="0 1" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-magenta-yellow"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.78039215686275 1" /><feFuncG type="table" tableValues="0 0.94901960784314" /><feFuncB type="table" tableValues="0.35294117647059 0.47058823529412" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-purple-green"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.65098039215686 0.40392156862745" /><feFuncG type="table" tableValues="0 1" /><feFuncB type="table" tableValues="0.44705882352941 0.4" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 0 0" width="0" height="0" focusable="false" role="none" style="visibility: hidden; position: absolute; left: -9999px; overflow: hidden;" ><defs><filter id="wp-duotone-blue-orange"><feColorMatrix color-interpolation-filters="sRGB" type="matrix" values=" .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 .299 .587 .114 0 0 " /><feComponentTransfer color-interpolation-filters="sRGB" ><feFuncR type="table" tableValues="0.098039215686275 1" /><feFuncG type="table" tableValues="0 0.66274509803922" /><feFuncB type="table" tableValues="0.84705882352941 0.41960784313725" /><feFuncA type="table" tableValues="1 1" /></feComponentTransfer><feComposite in2="SourceGraphic" operator="in" /></filter></defs></svg>        <header>            <nav class="bg-primary fixed-top navbar navbar-dark navbar-expand-md">                <div class="container">                    <a class="navbar-brand" href="/"><img src="https://ctemplar.com/wp-content/themes/ctemplar/assets/img/logo-plus-text.svg" alt="CTemplar's logo" height="40"/></a>                    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#drop-nav" aria-controls="drop-nav" aria-expanded="false" aria-label="Toggle navigation">                        <span class="navbar-toggler-icon"></span>                    </button>                    <div class="collapse navbar-collapse" id="drop-nav">                        <ul class="ml-auto navbar-nav">                            <li class="nav-item">                                <a class="nav-link" href="/about/">About</a>                            </li>                            <li class="nav-item">                                <a class="nav-link" href="/blog/">Blog</a>                            </li>                            <li class="nav-item">                                <a class="nav-link" href="/features/">Features</a>                            </li>                            <li class="nav-item">                                <a class="nav-link" href="/help/">Help</a>                            </li>                            <li class="nav-item">                                <a class="nav-link" href="/pricing/">Pricing</a>                            </li>                        </ul>                    </div>                </div>            </nav>        </header>        <main>                                                                    <div class="container my-5" style="max-width: 1024px;">                        <h1 class="mb-5 text-center">Zero Day Zimbra Mail Vulnerability Discovered</h1>                        <!-- wp:paragraph -->
<p>A new zero-day XSS vulnerability in the Zimbra webmail client, dubbed "Operation EmailThief" was discovered by the incident report company Volexity.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>According to a <a href="https://www.volexity.com/blog/2022/02/03/operation-emailthief-active-exploitation-of-zero-day-xss-vulnerability-in-zimbra/" target="_blank" rel="noreferrer noopener nofollow">blog post</a>, Volexity discovered a series of targeted spear-phishing campaigns last year in December against a customer from a threat actor identified as <strong>TEMP_Heretic.</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The attacker targeted organizations in the European government and media primarily.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="who-was-responsible-for-the-campaign">Who Was Responsible for the Campaign?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Although there's no confirmation, it doesn't appear the attack came from any previously classified threat groups.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>However, several things indicate that <strong>TEMP_Heretic </strong>is a Chinese APT actor, including:</p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li>The vast majority of phishing messages were sent during UTC+8 hours, somewhere between 4:00 AM and 8:30 AM, fitting the Chinese working hours</li><li>The email headers show the time zone as UTC +0800</li><li>The attacker also used JavaScript code and the headers in the Zimbra requests show that the time zone is "Asia/Hong_Kong"</li></ol>
<!-- /wp:list -->

<!-- wp:heading -->
<h2 id="how-did-the-campaign-work">How Did the Campaign Work?</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>The campaign itself had two phases, each with several waves, the reconnaissance and <a href="https://ctemplar.com/what-is-spear-phishing/" rel="noreferrer noopener" target="_blank">spear-phishing</a> phase.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The first phase was conducted on 14th December, while the second was done on 16th, 23rd, 24th and 27th December, 2021.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Here is an overview of the attack phases:</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"center","id":1986,"sizeSlug":"large","linkDestination":"none"} -->
<div class="wp-block-image"><figure class="aligncenter size-large"><img src="https://ctemplar.com/wp-content/uploads/2022/02/volexity-zimbra-blog-flowchart-1024x577.png" alt="spear-phishing phase" class="wp-image-1986"/><figcaption><em>Source: </em><a href="https://www.volexity.com/blog/2022/02/03/operation-emailthief-active-exploitation-of-zero-day-xss-vulnerability-in-zimbra/" target="_blank" rel="noreferrer noopener nofollow"><em>Volexity</em></a></figcaption></figure></div>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>The attacker also created 74 unique Outlook.com addresses for this campaign, with mostly female names (the names in some instances repeated as you can see in the two examples above). The format of these email addresses was usually <strong>&lt;first name&gt;_&lt;last name&gt;_&lt;random numbers&gt;@outlook.com</strong> or <strong>&lt;first name&gt;&lt;last name&gt;&lt;random numbers&gt;@outlook.com.</strong></p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 id="1st-phase-reconnaissance">1st Phase - Reconnaissance</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>During the first phase of the attack, the attacker would send email messages with generic subject lines that contained embedded remote images in the body, but otherwise no other content.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The image links were used to validate the email addresses and were unique for each target, which was mainly used to vet which targeted organization has a better chance to open the phishing message,</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The images had URI such as:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li><strong><em>hxxp://fireclaws.spiritfield[.]ga/[filename].jpeg?[integer]</em></strong></li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Where the <strong>[integer] </strong>part is used to pinpoint the victim itself.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>These emails also contained a subject line such as:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li><strong>Invitations</strong></li><li><strong>Warnings</strong></li><li><strong>Refund for airline tickets</strong></li></ul>
<!-- /wp:list -->

<!-- wp:heading {"level":3} -->
<h3 id="2nd-phase-main-spear-phishing-attack-and-using-xss-vulnerability">2nd Phase - Main Spear Phishing Attack and Using XSS Vulnerability</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Supposing that the reconnaissance phase was successful and the target opened the email message, the attacker moved on to the second and main phase of their attack.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This phase happened in multiple waves and the spear-phishing campaign was run during the second half of December, on 16th, 23rd, 24th and 27th.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The spear-phishing campaign had two themes:</p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li><strong>An invitation to a Sotheby's charity auction </strong>(such as the email below)</li></ol>
<!-- /wp:list -->

<!-- wp:image {"id":1988,"sizeSlug":"full","linkDestination":"none"} -->
<figure class="wp-block-image size-full"><img src="https://ctemplar.com/wp-content/uploads/2022/02/spear-phishing-campaign-theme.png" alt="spear-phishing campaign " class="wp-image-1988"/><figcaption><em>Source: </em><a href="https://www.volexity.com/blog/2022/02/03/operation-emailthief-active-exploitation-of-zero-day-xss-vulnerability-in-zimbra/" target="_blank" rel="noreferrer noopener nofollow"><em>Volexity</em></a></figcaption></figure>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>2. <strong>Fake interview requests from BBC, AFP, or other news companies </strong>(such as the email below)</p>
<!-- /wp:paragraph -->

<!-- wp:image {"align":"center","id":1989,"sizeSlug":"full","linkDestination":"none"} -->
<div class="wp-block-image"><figure class="aligncenter size-full"><img src="https://ctemplar.com/wp-content/uploads/2022/02/Fake-interview-requests.png" alt="Fake interview requests" class="wp-image-1989"/><figcaption><em>Source: </em><a href="https://www.volexity.com/blog/2022/02/03/operation-emailthief-active-exploitation-of-zero-day-xss-vulnerability-in-zimbra/" target="_blank" rel="noreferrer noopener nofollow"><em>Volexity</em></a></figcaption></figure></div>
<!-- /wp:image -->

<!-- wp:paragraph -->
<p>While most email messages were targeted to a specific victim and had custom content, some were more generic and mainly claiming to be from different airlines such as British Airways, Lufthansa, Air France, United Airlines, or Southwest Airlines, or from Amazon.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>These messages were mostly about Christmas and New Year greetings, inviting victims to click on a link in the email to receive a discount or check Amazon Prime.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>For example, an email from an airline might have a subject line such as:</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>"Merry Christmas and New Year from Lufthansa!"</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>And would also contain an embedded video or image that the user would click on.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The URI pattern used in the second phase was similar to the first one, with the exception that the subdomain was consistent this time around.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>These URIs typically had the following format:</p>
<!-- /wp:paragraph -->

<!-- wp:list -->
<ul><li><strong><em>hssps://update.secretstep[.]tk/[filename].jpeg?u=[integer]&amp;t=[second_integer]</em></strong></li></ul>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>Where the <strong>[second_integer] </strong>part indicates the targeted organization.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When the user clicks on a malicious link in the email message, the hacker's infrastructure would then redirect them to a page on the organization's Zimbra webmail host.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This page had a URI, formatted in such a way as to help the attacker load an arbitrary JavaScript code (provided the user is logged in) in the context of a Zimbra session.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Basically, if the user clicks on a malicious link and also leaves their browser window open, the remote attacker would be able to steal their mailbox contents.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>At the time of writing this, Zimbra has not released an official patch for the vulnerability.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="not-the-first-cross-site-scripting-xss-vulnerability-in-zimbra-webmail-client">Not the First Cross-Site Scripting XSS Vulnerability in Zimbra Webmail Client</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>This isn't the first cross-site scripting vulnerability found in the Zimbra webmail client.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Previously last year, <a href="https://blog.sonarsource.com/zimbra-webmail-compromise-via-email" target="_blank" rel="noreferrer noopener nofollow">SonarSource</a>, a Swiss-based company developing open-source software for continuous code quality and security, discovered two potential XSS vulnerabilities and exploits in Zimbra 8.8.15 and 9.0 series.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Thanks to these security vulnerabilities, an unauthenticated attacker could compromise an organization's Zimbra webmail server and even gain access to sent and received emails from all employees of that organization.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 id="what-are-the-vulnerabilities-in-question">What are the Vulnerabilities in Question?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>You can check the <a href="https://www.cvedetails.com/vulnerability-list/vendor_id-7863/Zimbra.html" target="_blank" rel="noreferrer noopener nofollow">CVE details </a>for both vulnerabilities here (CVE-2021-35208 and CVE-2021-35209)</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>1) CVE-2021-35208</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The first vulnerability was a cross-site scripting bug that activates in the victim's browser upon viewing a malicious email.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Cross-site scripting (XSS) is a code-injection attack where the attacker exploits a vulnerability in the website or app and injects a malicious code into the victim's computer. We explain more what it is in <a href="https://ctemplar.com/is-your-session-hijacked-how-to-prevent-session-hijacking/" target="_blank" rel="noreferrer noopener nofollow">this article</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>This email contained a crafted JavaScript payload. When the JS payload is executed, the hacker would gain unrestricted access to the employee's email account and their webmail sessions. From there, the attacker could also access other Zimbra features and use this as a springboard for further attacks.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p><strong>2) CVE-2021-35209</strong></p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The second vulnerability identified by SonarSource was an SSRF (Server-Side Request Forgery) vulnerability. SSRF vulnerabilities are an increasingly dangerous bug class, particularly for cloud-native applications (no information if Zimbra Cloud is affected by it).</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The vulnerability itself is a bypass of an allow-list that can be abused by an employee with any permission role. This could then allow the hacker to extract the AWS IAM credentials or Google Cloud API Tokens.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>Zimbra security team fixed both vulnerabilities with patches 18 for the 8.8.15 and Patch 16 for the 9.0 series. Note that versions before these on both branches are still vulnerable.</p>
<!-- /wp:paragraph -->

<!-- wp:heading {"level":3} -->
<h3 id="how-do-the-vulnerabilities-work">How Do the Vulnerabilities Work?</h3>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>In the blog post about the vulnerabilities, SonarSource also explains the technical details of how these work if you're interested in reading about them more.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In short, the cross-site scripting vulnerability exploits the fact that Zimbra uses three different clients to view emails:</p>
<!-- /wp:paragraph -->

<!-- wp:list {"ordered":true} -->
<ol><li>Desktop client</li><li>Static, HTML client</li><li>Mobile-optimized client</li></ol>
<!-- /wp:list -->

<!-- wp:paragraph -->
<p>In order for all three clients to have the same security guarantees, the HTML content from an incoming email is sanitized on the server-side using the <a href="https://github.com/OWASP/java-html-sanitizer" target="_blank" rel="noreferrer noopener nofollow">OWASP Java-HTML Sanitizer</a>.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>The problem with this is that each client can transform the trusted HTML of an email and display it in their own way. This can then lead to HTML being corrupted and an XSS attack.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>When it comes to the second vulnerability, this has more to do with one of Zimbra integrations, namely Webex and not Zimbra itself.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>In order to integrate Webex on front-end Ajax requests are needed to get the info from Webex, but the Same-Origin-Policy prevents this normally. However, Zimbra uses proxied requests through Servlet to fetch data from Webex instead.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>What this means is that an open redirect on a Webex domain leads to an SSRF vulnerability.</p>
<!-- /wp:paragraph -->

<!-- wp:heading -->
<h2 id="conclusion">Conclusion</h2>
<!-- /wp:heading -->

<!-- wp:paragraph -->
<p>Zimbra email platform is used by 200,000+ businesses, as well as more than 1,000 financial institutions and governments. However, these vulnerabilities can enable an unauthenticated attacker to steal the user's mail data and more.</p>
<!-- /wp:paragraph -->

<!-- wp:paragraph -->
<p>To protect your email from attacks that run arbitrary JavaScript, <a href="https://ctemplar.com/pricing/" rel="noreferrer noopener" target="_blank">sign up for CTemplar's secure email</a>. CTemplar is the only email service that provides checksums that show that our GitHub code is the same as you get on the website and not tampered with.</p>
<!-- /wp:paragraph -->        </main>        <footer>            <section class="bg-light mt-5 pb-5 pt-5 text-center text-sm-left">                <div class="container">                    <div class="row">                        <div class="col-3 d-md-block d-none text-center">                            <img class="img-fluid" src="https://ctemplar.com/wp-content/themes/ctemplar/assets/img/logo.svg" alt="CTemplar's logo" width="155"/>                        </div>                        <div class="col">                            <h3 class="font-weight-bold">Regain your right to privacy now!</h3>                            <p class="lead">Stand with us in the fight to protect privacy, civil liberties, and the right for anonymity. Create your anonymous encrypted email today.</p>                            <a class="btn btn-danger" href="/pricing/">Pricing</a>                            <a class="btn btn-outline-dark" href="/tor-browser/">Tor Browser</a>                        </div>                    </div>                </div>            </section>            <section class="bg-dark pb-3 pt-5 text-light footer">                <div class="container">                    <div class="row text-center">                        <div class="col-12 col-lg-3 col-md-4 col-sm-6 text-sm-left">                            <nav class="flex-column nav">                                <a class="nav-link pl-0 text-light" href="/about/">About</a>                                <a class="nav-link pl-0 text-light" href="/blog/">Blog</a>                                <a class="nav-link pl-0 text-light" href="/donate/">Donate</a>                            <a class="nav-link pl-0 text-light" href="/security/">Security</a>                            </nav>                        </div>                        <div class="col-12 col-lg-3 col-md-4 mt-5 mt-md-0 text-md-left">                                <a class="nav-link pl-0 text-light" href="/features/">Features</a>                                <a class="nav-link pl-0 text-light" href="/help/">Helpdesk</a>                                <a class="nav-link pl-0 text-light" href="/media-kit/">Media Kit</a>                        </div>                        <div class="col-12 col-lg-2 ml-auto mt-4 mt-lg-0 text-lg-left">                            <a class="nav-link pl-0 text-light" href="/privacy/">Privacy Policy</a>                            <a class="nav-link pl-0 text-light" href="/terms/">Terms &amp; Conditions</a>                            <a class="nav-link pl-0 text-light" href="/tor-browser/">Tor Browser</a>                        </div>                    </div>                    <h4 class="lead mt-5 text-center">Made with <i class="fa-heart fa-w-16 fas text-danger"></i> for Human Rights</h4>                    <hr>                    <div class="text-center">                        <small>&copy;2022 Templar Software Systems Ltd., a Seychelles Limited Liability Company.</small>                    </div>                </div>            </section>        </footer>        <script type='text/javascript' src='https://ctemplar.com/wp-content/themes/ctemplar/assets/js/jquery.slim.min.js' id='ctemplar-jqueryslim-js'></script><script type='text/javascript' src='https://ctemplar.com/wp-content/themes/ctemplar/assets/js/popper.min.js' id='ctemplar-popper-js'></script><script type='text/javascript' src='https://ctemplar.com/wp-content/themes/ctemplar/bootstrap/js/bootstrap.min.js' id='ctemplar-bootstrap-js'></script>        <script>            $(function () {                $('[data-toggle="popover"]').popover()            })        </script>    </body></html>